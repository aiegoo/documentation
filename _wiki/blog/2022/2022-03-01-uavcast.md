---
layout: post
title: "uavmatrix's cast pro docs"
name: "uavcast"
tags: [drone]
tagName: drone
permalink: 2022-03-01-uavcast.html
sidebar: other_sidebar
folder: blog
collection: wiki
categories: school
keywords: "uav gcs raspi network"
summary: "Tue, Mar 01, 22, another way to integrate devices to gcs"
excerpt_separator: <!--more-->
toc: true
public: true
parent: [[Wiki-Setting-Category]]
date: 2022-03-01T10:02:57 +0900
youtubeID: 4CNK3cBvUtg
updated: 2022-03-01 10:02
---
* TOC
{:toc}

{{site.data.alerts.callout_warning}}This is a draft, the content is not complete and of poor quality!{{site.data.alerts.end}}

## Installation

Start with a fresh Raspberry image.
Confirmed working images:

!!! warning "Bullseye release"

    Raspberry organisation just released (01.11.2021) new bullseye image wich is not yet compatible with UAVcast.
    Please use the previous buster releases from the links bellow:

- [Raspberry Pi OS Lite](https://downloads.raspberrypi.org/raspios_lite_armhf/images/raspios_lite_armhf-2021-05-28/2021-05-07-raspios-buster-armhf-lite.zip)
- [Raspberry Pi OS With Desktop](https://downloads.raspberrypi.org/raspios_armhf/images/raspios_armhf-2021-05-28/2021-05-07-raspios-buster-armhf.zip)


!!! note "Looking for other boards!"
    We are currently building UAVcast-Pro for other architectures and OS.
    [Check out our beta section](/pages/beta/)

See the [https://www.raspberrypi.org/software/operating-systems/](https://www.raspberrypi.org/software/operating-systems/) for installation instruction. <br>
Continue to install UAVcast-Pro as described in the [installation](/installation/#uavcast-pro-installation) section

##UAVcast-Pro installation


You can install the latest version of UAVcast-Pro by pasting this command into you RPI shell.

```bash
curl -s http://install.uavmatrix.com | sudo bash
```

After the installation there will be validating proccess to verify that all component has been loaded successfully.
You can now access the webinterface using the RPI ip or Host name address in your browser. [http://raspberrypi/](http://raspberrypi/)

### Navio Flight Controller
For Navio+ and Navio2 boards, please use the installation procedure below:

- Install the latest image provided by [https://emlid.com](https://emlid.com).
- Connect to your RPI with SSH and run the **emlidtool** as described in the emlid documentation.[https://docs.emlid.com/navio2/common/ardupilot/installation-and-running/#choosing-a-vehicle-version-and-board](https://docs.emlid.com/navio2/common/ardupilot/installation-and-running/#choosing-a-vehicle-version-and-board)
- Select your vehicle, version and frame.
- **On Boot** Select disable
- **Ardupilot** Select stop
- **Apply** and exit.
- Install UAVcast-Pro as described [uavcast-pro-installation](#uavcast-pro-installation)

  !['emlidtool Example'](images/pages/installation/emlidtool.jpg)
![image](https://user-images.githubusercontent.com/42961200/156092894-8e8c51c2-ff5d-44f9-860d-86d36bb70035.png)

## How does it work?
UAVcast-Pro is an application that provides an easier method for streaming mavlink (telemetry) data and video over a defined network.
It will connect to the Flight Controller using mavlink protocol and proxy these packages to a destination of your choice.

The behaviour is exaclty the same as when using regular telemetry module, there is no limitaion using UAVcast-Pro.

UAVcast-Pro will use the default network connection for streaming, and by using uavnet, the connection will also be secure.
Uavnet is a vpn built on the zerotier controller and provides secure peer to peer conectivity.

The application is hosted locally on your device, and there is no communication to a 3rd party!

#<!-- prettier-ignore -->
## Hardware

### TL;DR
You will need a raspbery pi and a mavlink flight controller to get going. You dont need a modem for testing locally in your home network, a local wifi or ethernet connection will work just fine.
As soon as you have configured everything and are ready to go flying, you need a modem, we recommend a HiLink (Plug and Play) type.

If you want to control your drone manually during flight, we also recommend using a USB gamepad connected to Mission Planner joystick integration.

See more info bellow.

##Flight Controllers

All Mavlink based boards are supported (PX4, Ardupilot).

The Ardupilot project is often adding support for other flight controllers.
The full list of supported flight controllers can be viewed here [http://ardupilot.org/plane/docs/common-autopilots.html](http://ardupilot.org/plane/docs/common-autopilots.html).

To mention some supported board:

- Pixhawk
- APMx
- Cube
- Matek
- Navio+
- Navio2

### Connection Methods
There is two ways to connect the FC to Raspberry PI, either using USB (preferred) or GPIO
There is no diffrence in performance but the USB connection is easier and more elegant.

####USB

- Connect a micro USB cable between the FC and RPI as shown in the picture bellow.

!!! warning "USB cross-sectional"

    Use a USB cable with large cross-sectional area to minimize the voltage drop supplied to Fligth Controller.

!['Usb'](images/pages/Flight-Controller/rpi-usb.jpg)
![image](https://user-images.githubusercontent.com/42961200/156089747-83fa9174-9e09-487f-8a52-a139d883d397.png)

#### GPIO

- Its very imporant to connect tx, rx and ground if you want to use GPIO, and not only tx & rx.

!!! warning

    RPI cannot be powered by FC telem port.  [Make sure you use proper power source for rpi.](/hardware/#power-supply)

!['Gpio'](images/pages/Flight-Controller/rpi.jpg)
![image](https://user-images.githubusercontent.com/42961200/156089728-20ad747c-8378-47c0-960a-062f5f6b1dd1.png)

## Supported Raspberry Pi boards

- Pi0w
- PI 2
- Pi 3
- Pi 4

!!! warning "Pi0w"

    Pi0w runs fine with UAVcast-Pro, however the CPU usage will be between 50 > 100%.<br>
    Some functionalities has been disabled to reduce the CPU load!

If you intend to use other programs with UAVcast-Pro then Pi3 or 4 version is recommended.

##Power supply
It's important that Raspberry Pi gets voltage between **4.8 and 5.3v**. If you use LTE modem, make sure you are not overloading the USB port per. design.

Read the modem specification / datasheet and make sure the modem is not consuming more than MAX output defined in the table below.

!!! info "USB Camera"

    If you use USB camera, make sure you include the camera consumption as well.

[https://www.raspberrypi.org/documentation/hardware/raspberrypi/power/README.md](https://www.raspberrypi.org/documentation/hardware/raspberrypi/power/README.md)

- **Limited by PSU** referes the value from the (Recommended PSU current capacity). Make sure you use a proper power supply that are able to deliver above this value.

  !['pi power table'](images/pages/hardware/pi-power.jpg)
![image](https://user-images.githubusercontent.com/42961200/156089785-57339b2a-5d4e-45b0-93bb-05c6c6524701.png)

If you need to add external power, please see instructions bellow.
This is one solution, where we attach the power directly to the USB +/- pins, and one wire to the RPI fuse. The latter will make sure RPI is booting automatically when powered.

!!! note

    Make sure you connect the modem to correct USB port where external power supply is connected.

!['raspberry power supply'](images/raspberry-power.png)
!['raspberry power supply'](images/raspberry-power.jpg)
![image](https://user-images.githubusercontent.com/42961200/156089802-aae7efab-3173-4e1a-8019-929757620078.png)
![image](https://user-images.githubusercontent.com/42961200/156089811-bce48113-5348-4f58-b640-29f60b479e4d.png)

## Modem

UAVcast uses modem manager and network manager to control the LTE connection.
Check out this page to find supported modems, [Supported modem](https://www.freedesktop.org/wiki/Software/ModemManager/SupportedDevices/)

###Recommended Huawei HiLink modems by Countries

!!! note

    Please send a mail to **support@uavmatrix.com** or open a new PR on [github](https://github.com/UAVmatrix/uavcast-pro-docs) if you know of other working Huawei modems in your country!

|    Country     |        Carrier         |            Recommended Modem            |                            Recommended APN                             |
| :------------: | :--------------------: | :-------------------------------------: | :--------------------------------------------------------------------: |
|   Australia    |        Telstra         |        E3372h-153<br>E3372h-607         |                    telstra.wap <br>telstra.internet                    |
|    Austria     | bob A1 Telekom Austria |        E3372h-153<br>E3372h-607         |                                 bob.at                                 |
|    Bulgaria    |        Vivacom         |        E3372h-153<br>E3372h-607         |                          internet.vivacom.bg                           |
| Czech Republic |           O2           |        E3372h-153<br>E3372h-607         |                                internet                                |
| Czech Republic |        Vodafone        |        E3372h-153<br>E3372h-607         |                                internet                                |
|     France     |        Bouygues        |        E3372h-153<br>E3372h-607         |                            mmsbouygtel.com                             |
|     France     |         Orange         |        E3372h-153<br>E3372h-607         |                           orange.fr / orange                           |
|     France     |          SFR           |        E3372h-153<br>E3372h-607         |                                 websfr                                 |
|    Germany     |        T-Mobile        |        E3372h-153<br>E3372h-607         |                            internet.t-d1.de                            |
|    Germany     |           O2           |        E3372h-153<br>E3372h-607         |                                internet                                |
|    Germany     |        Vodafone        |        E3372h-153<br>E3372h-607         |                            web.vodafone.de                             |
|     Greece     |        Cosmote         |        E3372h-153<br>E3372h-607         |                                internet                                |
|     Greece     |      WIND Hellas       |        E3372h-153<br>E3372h-607         |                            gint.b-online.gr                            |
|    Hungary     |     Magyar Telekom     |        E3372h-153<br>E3372h-607         |                            internet.telekom                            |
|     Italy      |         Iliad          |        E3372h-153<br>E3372h-607         |                                 iliad                                  |
|     Italy      |          TIM           |        E3372h-153<br>E3372h-607         |                              ibox.tim.it                               |
|     Italy      |        Vodafone        |        E3372h-153<br>E3372h-607         |                             web.omnitel.it                             |
|     Latvia     |         Tele2          |        E3372h-153<br>E3372h-607         |                        mobileinternet.tele2.lv                         |
|    Malaysia    |          DiGi          |        E3372h-153<br>E3372h-607         |                                diginet                                 |
|  Netherlands   |        T-Mobile        |        E3372h-153<br>E3372h-607         |                                internet                                |
|     Norway     |        Telenor         |        E3372h-153<br>E3372h-607         |                       internet.public / internet                       |
|     Poland     |         Orange         |        E3372h-153<br>E3372h-607         |                                internet                                |
|    Portugal    |        Vodafone        |        E3372h-153<br>E3372h-607         |                          internet.vodafone.pt                          |
|   Singapore    |        Singtel         |        E3372h-153<br>E3372h-607         |                                e-ideas                                 |
|   Singapore    |        StarHub         |        E3372h-153<br>E3372h-607         |                                 shwap                                  |
|     Spain      |        Movistar        |        E3372h-153<br>E3372h-607         |                              movistar.es                               |
|     Spain      |         Yoigo          |        E3372h-153<br>E3372h-607         |                                internet                                |
|     Sweden     |        Halebop         |        E3372h-153<br>E3372h-607         |                            halebop.telia.se                            |
|     Sweden     |         Tele2          |        E3372h-153<br>E3372h-607         |                              4G.tele2.se                               |
|     Sweden     |        Telenor         |        E3372h-153<br>E3372h-607         |                          internet.telenor.se                           |
|     Sweden     |         Telia          |        E3372h-153<br>E3372h-607         |                            online.telia.se                             |
|  Switzerland   |          Salt          |        E3372h-153<br>E3372h-607         |                                internet                                |
|  Switzerland   |        Sunrise         |        E3372h-153<br>E3372h-607         |                                internet                                |
|  Switzerland   |        Swisscom        |        E3372h-153<br>E3372h-607         |                            gprs.swisscom.ch                            |
|  Switzerland   |        Swisscom        |        E3372h-153<br>E3372h-607         | corporate.swisscom.ch APN User: testprofil and APN Password: temporary |
|     Turkey     |        Turkcell        |        E3372h-153<br>E3372h-607         |                             mgb / internet                             |
|       UK       |           EE           |        E3372h-153<br>E3372h-607         |                               everywhere                               |
|      USA       |          AT&T          |               E3372h-510                |                                various                                 |
|      USA       |         Sprint         |                 No info                 |                                No Info                                 |
|      USA       |        T-Mobile        | E3372h-510<br>E3276s-505<br>MS2372h-517 |                   fast.t-mobile.com, epc.tmobile.com                   |
|      USA       |        Verizon         |               E3372h-510                |                              vzwinternet                               |


!!!success "Modem LED Status"

    - Green, flashing twice every 2s: The USB-Modem is powered on.
    - Green, flashing once every 0.2s: The software of the USB-Modem is being upgraded.
    - Green, flashing once every 2s: The USB-Modem is registering with a 2G network.
    - Blue, flashing once every 2s: The USB-Modem is registering with a 3G network.
    - Cyan, flashing once every 2s: The USB-Modem is registering with a 4G network.
    - Green, solid: The USB-Modem is connected to a 2G network.
    - Blue, solid: The USB-Modem is connected to a 3G network.
    - Cyan, solid: The USB-Modem is connected to a 4G network.


**HiLink or Stick modems**

Some Huawei USB modems have a mode called "HiLink" which provides for "driverless" installation on Windows, Macintosh and Linux computers. These modems usually have the HiLink logo marked on the outside, or have letter H in the model name. **Example E3372H**. All modems in the table above is HiLink!

Stick modems is a regular modem where you need to send AT commands to establish a cell connection. UAVcast has all the connection stuff you need integrate a stick modem.

**HiLink Advantages**

The big advantages being that the connection time is very fast and hassle free.
A HiLink modem uses a web browser to access the modem settings.

It acts more or less like a plug and play modem, you don't need to configure any parameters in UAVcast-Pro or Raspberry Pi.

**HiLink Disadvantages**

Hilink modems does not support Port Forwarding out of the box. You certainly almost every-time need to flash new firmware to access the Port Forwarding menu in the modem web interface.

However, if you use VPN connection then HiLink is a perfect choice as VPN does't not require any port forwarding.

## Camera

There are several cameras that works with UAVcast-Pro,

- PiCam
- Logitech C920
- Logitech C615
- GoPro. ([Can be used with HDMI to CSI converter](https://www.ebay.com/itm/1-Port-For-Raspberry-Pi-HDMI-To-CSI-2-Bridge-Adapter-Module-UP-To-1080p-25fps-/233297430162)). This allows users to record and view live stream simultaneously.

  !['UAVcast-Pro and GoPro'](images/pages/hardware/gopro.jpg)
![image](https://user-images.githubusercontent.com/42961200/156089839-21b71f9b-aa18-4ec9-9b4a-e71d59eb1260.png)

- Supported GoPro cams:

  - HERO7 Black
  - HERO (2018)
  - HERO6 Black
  - HERO5 Black
  - HERO4 (Black and Silver Editions)
  - HERO3+ (Black and Silver Editions)
  - HERO3 (White, Silver, and Black Editions)
  - HERO2)
    - GoPro example video from one of our users.
    <iframe width="560" height="315" src="https://www.youtube.com/embed/4CNK3cBvUtg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
{% include youtubePlayer.html id=page.youtubeID %}

- Other cameras may also work. search for (camera type) and gStreamer.

<!-- PiCam is a perfect camera for this type application and provides 1080p video.
If you want to use another camera not listed, then make sure it has Hardware Encoder integrated to get the best quality. -->

[Mission Planner](http://ardupilot.org/planner/docs/mission-planner-installation.html) and [QGroundControl](http://qgroundcontrol.com/) supports video stream by default on port 5600.

## Cockpit

Cockpit gives you a nice overview of your vechile position with mavlink telemetry data. Some basic commands can be triggered within the map.

You can select how fast the update intervall should be between your flight controller and map from 1 - 5 Hz. It's recommended to lower the interval if you use PiZero due to the limited resources.
!['Cockpit'](../images/pages/Cockpit/main.jpg)
![image](https://user-images.githubusercontent.com/42961200/156093062-8acb0b6b-5aba-489d-97ab-d9629e1818e7.png)

### In browser video
You are able to receive live video feed from your picam within the map. The video container can be scaled and positioned / dragged anywhere in the window.

### Telemetry
Cockpit gives you live telemtry data listed on the left hand side.

### Commands
You can send some basic commands from the map such as enable GCS failsafe, trigger RTL, Loiter, Pre-flight check and show your missions.

## Dashboard

!['Dashboard'](../images/pages/dashboard/dashboard.jpg)
![image](https://user-images.githubusercontent.com/42961200/156093190-3e525dd2-68cc-4f61-90c5-cd95cfe052de.png)

Dashboard provides a overview of the current casting status and Raspberry Pi internal memory and storage. There is one LED for each item you have enabled in the menu, displaying green or red status of its current operating state.

!['Dashboard'](../images/pages/dashboard/led.jpg)
![image](https://user-images.githubusercontent.com/42961200/156093258-db97b649-18dd-4ce1-994d-769f6d400322.png)

### Start / Stop UAVcast-Pro
You can start and stop UAVcast-Pro from the dashboard. This will simulate the exact start up sequence when Raspberry Pi boots up (if autoboot is enabled).
If you get all green led's then all selected items have started as expected.

This is a nice way to verify that UAVcast-Pro will start as expected when Raspberry Pi starts up.

!['Dashboard start'](../images/pages/dashboard/dashstart.jpg)
![image](https://user-images.githubusercontent.com/42961200/156093296-c60147a4-ecee-440d-98e2-71bf887cb1b5.png)

### Enable  / Disable Autostart

If autostart is enable, then UAVcast-Pro will start all enabled functions every time Raspberry Pi boots up.

### CPU

Under-voltage detection, CPU throttling and temperature is shown on the dashboard. When an under-voltage or CPU throttling is detected these icons will turn from green to red.

!['Network Statistics'](../images/pages/dashboard/cpu.jpg)
![image](https://user-images.githubusercontent.com/42961200/156093314-822d635f-7879-4170-9973-0e220ab07bc0.png)

!!! warning
    It is recommended to use a stable 5v power supply for the Raspberry Pi, this can be achieved using a UBEC or similar. It is not recommended to power your Raspberry Pi from the servo rail as voltage drop can occur.


### Network Statistics

You are able to view network statistics from the dashboard for all network adapters that have been configured - These stats update every 10 seconds.

!['Network Statistics'](../images/pages/dashboard/networkstats.jpg)
![image](https://user-images.githubusercontent.com/42961200/156093340-c3344acd-4b9a-4a4a-bc13-fe751f850fa0.png)

### Storage / Memory
!['Memory'](../images/pages/dashboard/storage.jpg)
Overview of free space and used memory
![image](https://user-images.githubusercontent.com/42961200/156093368-69f2f743-cf85-4855-a2d9-63fd7c13ea81.png)


## Flight Controller
!['Flight Controller Selection'](../images/pages/Flight-Controller/fc-type.jpg)
![image](https://user-images.githubusercontent.com/42961200/156093460-d71115da-5a5d-42f5-8210-8e2aa9a2030f.png)

Configure the connection between Raspberry and the Flight Controller.

### Controller Type

- Default value: `None`
- Options: `Ardupilot, Navio`

Choose the board you want to use. for Pixhawk, APM, Cube or other Ardupilot variants select Ardupilot.

### Vehicle (Navio Only)

- Options:`ArduPlane, ArduRover, ArduCopter`

Select the binary you want use.

### Connection Method

- Options:`USB, GPIO`

  Select the communcation method you use

### Baud rate

- Default value: `57600`
- Options: `9600, 57600, 115200`

Select a baud rate you want to use for the telemetry stream.

### Protocol

- Default value: `TCP`
- Options: `TCP, UDP`

Select the protocol you want to use for the telemetry stream.

### FC Internal Address

- Default value: USB `/dev/ttyACM0`, GPIO:`/dev/ttyAMA0`

This is the internal address raspberry uses for communication with Flight Controller.
Only change if you know what you are doing!

### Validate Mavlink Connection
Check if raspberry Pi receives mavlink messages from your FlightController. This is usefull when troubleshooting. UAVcast will check if valid HEARTBEAT message is received on the selected connection method above.
Its recommended to run this test after a reboot

#### Success
!['Flight Controller Connection Check'](../images/pages/Flight-Controller/fc_check_success.jpg)
![image](https://user-images.githubusercontent.com/42961200/156093603-9833dbc5-a3ef-4da9-8abc-8281e4ec4279.png)

#### Failed
!['Flight Controller Connection Check'](../images/pages/Flight-Controller/fc_check_failed.jpg)
![image](https://user-images.githubusercontent.com/42961200/156093594-4287ac26-2486-46bc-843d-63ff9349349f.png)


{% include taglogic.html %}

{% include links.html %}

{% include commento.html %}

{{site.data.alerts.hr_shaded}}
